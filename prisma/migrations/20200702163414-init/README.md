# Migration `20200702163414-init`

This migration has been generated by Mar-er at 7/2/2020, 4:34:14 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP TABLE `difflife`.`Post`;

DROP TABLE `difflife`.`Profile`;

DROP TABLE `difflife`.`User`;

CREATE TABLE `difflife`.`User` (
`createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,`email` varchar(191)   ,`id` varchar(191) NOT NULL  ,`name` varchar(191)   ,`password` varchar(191)   ,`roles` varchar(191) NOT NULL  ,`updatedAt` datetime(3) NOT NULL  ,
    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `difflife`.`Account` (
`balance` Decimal(65,30) NOT NULL DEFAULT 0 ,`createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,`currency` ENUM('USD', 'EUR', 'RUB') NOT NULL DEFAULT 'USD' ,`id` varchar(191) NOT NULL  ,`name` varchar(191) NOT NULL  ,`updatedAt` datetime(3) NOT NULL  ,`userId` varchar(191) NOT NULL ,
    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `difflife`.`Transaction` (
`accountId` varchar(191) NOT NULL ,`amount` Decimal(65,30) NOT NULL  ,`createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,`id` varchar(191) NOT NULL  ,`updatedAt` datetime(3) NOT NULL  ,
    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE UNIQUE INDEX `User.email` ON `difflife`.`User`(`email`)

ALTER TABLE `difflife`.`Account` ADD FOREIGN KEY (`userId`) REFERENCES `difflife`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `difflife`.`Transaction` ADD FOREIGN KEY (`accountId`) REFERENCES `difflife`.`Account`(`id`) ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200702163414-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,53 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource db {
+  provider = "mysql"
+  url = "***"
+}
+
+
+model User {
+  id        String              @id @default(cuid())
+  createdAt DateTime    @default(now())
+  updatedAt DateTime    @updatedAt
+  name      String?
+  accounts  Account[]
+  email     String?     @unique
+  password  String?
+  // roles     UserRole[]
+  roles     String
+}
+
+model Account {
+  id            String              @id @default(cuid())
+  createdAt     DateTime      @default(now())
+  updatedAt     DateTime      @updatedAt
+  name          String
+  currency      Currency      @default(USD)
+  balance       Float         @default(0)
+  user          User          @relation(fields:[userId])
+  userId        String
+  transactions  Transaction[]
+}
+
+model Transaction {
+  id        String              @id @default(cuid())
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+  amount    Float
+  account   Account  @relation(fields: [accountId])
+  accountId String
+}
+
+// enum UserRole {
+//   ADMIN
+//   EMPLOYEE
+// }
+
+enum Currency {
+  USD
+  EUR
+  RUB
+}
```
